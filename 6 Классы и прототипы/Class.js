/*
-----------------------------------------------------------
CLASS — ЧТО ЭТО ТАКОЕ
-----------------------------------------------------------

class — это синтаксический сахар над:
- функцией-конструктором
- prototype
- прототипным наследованием

ВАЖНО:
❗ В JavaScript НЕТ настоящих классов, как в Java / C++
❗ Под капотом всё остаётся прототипами

class просто:
- делает код читабельнее
- уменьшает количество ошибок
- ближе к классическому ООП мышлению
*/

/*
-----------------------------------------------------------
CONSTRUCTOR
-----------------------------------------------------------

constructor — специальный метод класса

- вызывается автоматически при new
- инициализирует свойства экземпляра
- this внутри constructor — это новый объект

Пример жизненного цикла:
1. new User()
2. создаётся пустой объект {}
3. this указывает на него
4. вызывается constructor
5. объект возвращается
*/

/*
-----------------------------------------------------------
ГДЕ ХРАНЯТСЯ ДАННЫЕ И МЕТОДЫ
-----------------------------------------------------------

class User {
  constructor() {
    this.name = "Anna";
  }

  greet() {}
}

Фактически создаётся:

User            → функция-конструктор
User.prototype  → объект с методами

Экземпляр:
u = new User()

u → { name: "Anna" }
u.__proto__ === User.prototype
*/

/*
-----------------------------------------------------------
ОБЫЧНЫЕ МЕТОДЫ КЛАССА
-----------------------------------------------------------

Методы, объявленные в теле class:
- НЕ копируются в каждый объект
- лежат в prototype
- общие для всех экземпляров

Это экономит память ✔
*/

/*
-----------------------------------------------------------
GET / SET (ГЕТТЕРЫ И СЕТТЕРЫ)
-----------------------------------------------------------

get:
- позволяет обращаться к методу как к свойству
- используется для вычисляемых значений

set:
- позволяет перехватывать присваивание
- удобно для валидации

Пример мышления:
obj.value        → get value()
obj.value = 10   → set value(10)
*/

/*
-----------------------------------------------------------
STATIC — СТАТИЧЕСКИЕ МЕТОДЫ И СВОЙСТВА
-----------------------------------------------------------

static:
- принадлежит КЛАССУ
- НЕ принадлежит экземпляру
- вызывается через ClassName.method()

Применение:
- утилиты
- фабрики
- константы
- вспомогательная логика

Важно:
Экземпляр НЕ ВИДИТ static
*/

/*
-----------------------------------------------------------
НАСЛЕДОВАНИЕ: extends
-----------------------------------------------------------

class Dog extends Animal

Это означает:
Dog.prototype.__proto__ === Animal.prototype

Цепочка:
dog → Dog.prototype → Animal.prototype → Object.prototype → null
*/

/*
-----------------------------------------------------------
SUPER
-----------------------------------------------------------

super():
- вызывает constructor родителя
- ОБЯЗАТЕЛЕН, если есть constructor в наследнике
- должен вызываться ДО this

Почему?
Потому что:
this ещё не создан, пока родитель не инициализировал объект
*/

/*
-----------------------------------------------------------
ПЕРЕОПРЕДЕЛЕНИЕ МЕТОДОВ
-----------------------------------------------------------

Если метод есть и у родителя, и у наследника:
- используется метод ближайшего прототипа
- родительский можно вызвать через super.method()
*/

/*
-----------------------------------------------------------
INSTANCEOF
-----------------------------------------------------------

instanceof:
- НЕ проверяет тип напрямую
- проверяет наличие prototype в цепочке

obj instanceof Class

true, если:
Class.prototype есть в __proto__ цепочке obj
*/

/*
-----------------------------------------------------------
ПРИВАТНЫЕ СВОЙСТВА (#property)
-----------------------------------------------------------

#property:
- настоящая приватность
- доступ ТОЛЬКО внутри класса
- нельзя обратиться снаружи
- нельзя получить через Object.keys
- нельзя подменить

Это:
✔ безопасно
✖ менее гибко
*/

/*
-----------------------------------------------------------
ЗАЩИЩЁННЫЕ СВОЙСТВА (_property)
-----------------------------------------------------------

_property:
- НЕ является приватным
- это договорённость, а не защита
- доступен извне
- используется по соглашению

Применяется, когда:
- нужно наследование
- но не хочется публичного API
*/

/*
-----------------------------------------------------------
CLASS vs FUNCTION-КОНСТРУКТОР
-----------------------------------------------------------

class:
✔ всегда strict mode
✔ нельзя вызвать без new
✔ методы non-enumerable
✔ читаемость
✔ меньше ошибок

function Constructor:
✔ гибкость
✖ больше ручной работы
✖ выше шанс ошибок
*/

/*
-----------------------------------------------------------
NON-ENUMERABLE МЕТОДЫ
-----------------------------------------------------------

Методы класса:
- не участвуют в for...in
- не попадают в Object.keys
- ведут себя как нативные методы Array, Object и т.д.

Это:
✔ чистые объекты
✔ меньше шума
*/

/*
-----------------------------------------------------------
ЧАСТЫЕ ОШИБКИ
-----------------------------------------------------------

❌ Вызов class без new
❌ Добавление методов в constructor
❌ Злоупотребление static
❌ Наследование ради наследования
❌ Расширение Array.prototype / Object.prototype
*/

/*
-----------------------------------------------------------
КОГДА ИСПОЛЬЗОВАТЬ CLASS
-----------------------------------------------------------

✔ когда есть сущность (User, Order, Product)
✔ когда есть состояние + поведение
✔ когда есть иерархия
✔ когда нужен понятный API

✖ не нужен для утилит
✖ не нужен для простых объектов
*/

/*
-----------------------------------------------------------
ГЛАВНАЯ МЫСЛЬ
-----------------------------------------------------------

class — это НЕ магия
class — это:
функции + prototype + синтаксический комфорт

Понимаешь prototype → понимаешь class
*/
